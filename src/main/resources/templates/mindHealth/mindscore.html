<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>위더스</title>
    <meta name="viewport"
          content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"/>

    <link th:href="@{/css/reset.css}" rel="stylesheet">
    <link th:href="@{/css/common.css}" rel="stylesheet">
    <link th:href="@{/css/layout.css}" rel="stylesheet">
    <script th:src="@{/js/jquery-1.12.4.min.js}"></script>
    <script th:src="@{/js/common.js}"></script>
    <script th:src="@{/js/help.js}"></script>
    <script th:src="@{/js/input_limit.js}"></script>
    <script th:src="@{/js/mindHealth/minddiary.js}"></script>
    <script th:src="@{/js/durationTime.js}"></script>
    <script src="https://kit.fontawesome.com/e381c8a508.js" crossorigin="anonymous"></script>
</head>
<body>

<input type="hidden" id="button-count" th:attr="value=@{/button-count}">
<input type="hidden" id="helper-request" th:attr="value=@{/helper-request}">
<div class="skip-navi">
    <a href="#content">본문 바로가기</a>
</div>
<div th:if="${type} == ${T(withus.entity.User.Type).PATIENT} and ${week} != 25">
    <input type='hidden' name="symptom" th:value="${mainCount.symptom}" style="display:none">
    <input type='hidden' name="medicine" th:value="${mainCount.medicine}" style="display:none">
    <input type='hidden' name="mindHealth" th:value="${mainCount.mindHealth}" style="display:none">
    <input type='hidden' name="board" th:value="${mainCount.board}" style="display:none">
    <input type='hidden' name="alarm" th:value="${mainCount.alarm}" style="display:none">
    <input type='hidden' name="bloodPressure" th:value="${mainCount.bloodPressure}" style="display:none">
    <input type='hidden' name="diseaseInfo" th:value="${mainCount.diseaseInfo}" style="display:none">
    <input type='hidden' name="exercise" th:value="${mainCount.exercise}" style="display:none">
    <input type='hidden' name="goal" th:value="${mainCount.goal}" style="display:none">
    <input type='hidden' name="helper" th:value="${mainCount.helper}" style="display:none">
    <input type='hidden' name="level" th:value="${mainCount.level}" style="display:none">
    <input type='hidden' name="natriumMoisture" th:value="${mainCount.natriumMoisture}" style="display:none">
    <input type='hidden' name="weight" th:value="${mainCount.weight}" style="display:none">
    <input type='hidden' name="withusRang" th:value="${mainCount.withusRang}" style="display:none">
    <input type='hidden' name="infoEdit" th:value="${mainCount.infoEdit}" style="display:none">
    <input type='hidden' name="board" th:value="${mainCount.board}" style="display:none">

    <input type='hidden' name="recommendDiet" th:value="${detailCount.recommendDiet}" style="display:none">
    <input type='hidden' name="meditation" th:value="${detailCount.meditation}" style="display:none">
    <input type='hidden' name="bodyActivity" th:value="${detailCount.bodyActivity}" style="display:none">
    <input type='hidden' name="deepBreath" th:value="${detailCount.deepBreath}" style="display:none">
    <input type='hidden' name="consulting" th:value="${detailCount.consulting}" style="display:none">
    <input type='hidden' name="medicineAlarm" th:value="${detailCount.medicineAlarm}" style="display:none">
    <input type='hidden' name="bloodPressureAlarm" th:value="${detailCount.bloodPressureAlarm}" style="display:none">
    <input type='hidden' name="exerciseAlarm" th:value="${detailCount.exerciseAlarm}" style="display:none">
    <input type='hidden' name="symptomAlarm" th:value="${detailCount.symptomAlarm}" style="display:none">
    <input type='hidden' name="natriumMoistureAlarm" th:value="${detailCount.natriumMoistureAlarm}" style="display:none">
    <input type='hidden' name="waterIntakeAlarm" th:value="${detailCount.waterIntakeAlarm}" style="display:none">
    <input type='hidden' name="weightAlarm" th:value="${detailCount.weightAlarm}" style="display:none">
    <input type='hidden' name="mindScoreAlarm" th:value="${detailCount.mindScoreAlarm}" style="display:none">
</div>
<div th:if="${type} == ${T(withus.entity.User.Type).CAREGIVER} and ${week} != 25">
    <input type='hidden' name="goal" th:value="${mainCount.goal}" style="display:none">
    <input type='hidden' name="level" th:value="${mainCount.level}" style="display:none">
    <input type='hidden' name="withusRang" th:value="${mainCount.withusRang}" style="display:none">
    <input type='hidden' name="diseaseInfo" th:value="${mainCount.diseaseInfo}" style="display:none">
    <input type='hidden' name="helper" th:value="${mainCount.helper}" style="display:none">
    <input type='hidden' name="medicine" th:value="${mainCount.medicine}" style="display:none">
    <input type='hidden' name="bloodPressure" th:value="${mainCount.bloodPressure}" style="display:none">
    <input type='hidden' name="exercise" th:value="${mainCount.exercise}" style="display:none">
    <input type='hidden' name="familyObservation" th:value="${mainCount.familyObservation}" style="display:none">
    <input type='hidden' name="dietManagement" th:value="${mainCount.dietManagement}" style="display:none">
    <input type='hidden' name="weight" th:value="${mainCount.weight}" style="display:none">
    <input type='hidden' name="mindHealth" th:value="${mainCount.mindHealth}" style="display:none">
    <input type='hidden' name="alarm" th:value="${mainCount.alarm}" style="display:none">
    <input type='hidden' name="board" th:value="${mainCount.board}" style="display:none">
    <input type='hidden' name="infoEdit" th:value="${mainCount.infoEdit}" style="display:none">

    <input type='hidden' name="recommendDiet" th:value="${detailCount.recommendDiet}" style="display:none">
    <input type='hidden' name="meditation" th:value="${detailCount.meditation}" style="display:none">
    <input type='hidden' name="bodyActivity" th:value="${detailCount.bodyActivity}" style="display:none">
    <input type='hidden' name="deepBreath" th:value="${detailCount.deepBreath}" style="display:none">
    <input type='hidden' name="consulting" th:value="${detailCount.consulting}" style="display:none">
    <input type='hidden' name="medicineAlarm" th:value="${detailCount.medicineAlarm}" style="display:none">
    <input type='hidden' name="bloodPressureAlarm" th:value="${detailCount.bloodPressureAlarm}" style="display:none">
    <input type='hidden' name="exerciseAlarm" th:value="${detailCount.exerciseAlarm}" style="display:none">
    <input type='hidden' name="symptomAlarm" th:value="${detailCount.symptomAlarm}" style="display:none">
    <input type='hidden' name="natriumMoistureAlarm" th:value="${detailCount.natriumMoistureAlarm}" style="display:none">
    <input type='hidden' name="lewaterIntakeAlarmvel" th:value="${detailCount.waterIntakeAlarm}" style="display:none">
    <input type='hidden' name="weightAlarm" th:value="${detailCount.weightAlarm}" style="display:none">
    <input type='hidden' name="mindDiaryAlarm" th:value="${detailCount.mindDiaryAlarm}" style="display:none">
    <input type='hidden' name="mindScoreAlarm" th:value="${detailCount.mindScoreAlarm}" style="display:none">
</div>


<header>
    <div class="header-wrap type01">
        <div class="head" th:if="${type} == ${T(withus.entity.User.Type).PATIENT} and ${week} != 25">
            <div onclick="helperRequest()">
                <a class="btn xsm type07" href="tel:010-8454-9186" onclick="addHelper()">
                    <span class="ico-call"></span>
                    <span class="txt-rt">도우미</span>
                </a>
            </div>
            <h2>
                <span>마음 점수</span>
            </h2>
            <div class="col text-end" style="font-size: 20px; margin-top: 0.73vh;">
                <a th:href="@{/center}" class="align-middle"><i class="fa-solid fa-house fa-xl"
                                                                style="color: #00b050;"></i></a>
            </div>
        </div>
        <div class="head" th:if="${type} == ${T(withus.entity.User.Type).CAREGIVER} or ${week} == 25">
            <div onclick="helperRequest()">
                <a class="btn xsm type07" href="tel:010-8454-9186">
                    <span class="ico-call"></span>
                    <span class="txt-rt">도우미</span>
                </a>
            </div>
            <h2>
                <span>마음 점수</span>
            </h2>
            <div class="col text-end" style="font-size: 20px; margin-top: 0.73vh;">
                <a th:href="@{/center}" class="align-middle"><i class="fa-solid fa-house fa-xl"
                                                                style="color: #00b050;"></i></a>
            </div>

        </div>
    </div>
</header>
<form id="mindHealth-form" th:action="@{/minddiary}" onsubmit="return onFormSubmission(this);">
<div class="container" id="content">
    <div class="cont-wrap type01">
        <div class="txt-m" style="padding:15px ">
    <span style="font-size:18px;line-height:2.0;">
        다음은 마음 상태에 대해 묻는</br>
        질문입니다. 내용을 읽고 해당되는</br>
        것을 선택해 주세요</br>
    </span>
            <div class="txt-m" style="padding:10px ">
            <span style="font-size:20px;line-height:2.0;">
                1. 매사에 즐거움이나 흥미가 없다.</span>
            </div>
            <div class="rdo-wrap grid-col type09">
                <div class="rdo-box" id="chk_no" data-value="0"  onclick="mindscore_survey(this)">
                    <input type="radio"  id="chk1" value="0">
                    <label for="chk1">전혀 없다</label>
                </div>

                <div class="rdo-box" id="chk_few" data-value="1" onclick="mindscore_survey(this)">
                    <input type="radio"  id="chk2" value="1">
                    <label for="chk2">며칠 동안</label>
                </div>

                <div class="rdo-box" id="chk_week" data-value="2" onclick="mindscore_survey(this)">
                    <input type="radio"  id="chk3" value="2">
                    <label for="chk3">일주일 이상</label>
                </div>

                <div class="rdo-box" id="chk_day"  data-value="3" onclick="mindscore_survey(this)">
                    <input type="radio"  id="chk4" value="3">
                    <label for="chk4">거의 매일</label>
                </div>

            </div>

        </div>
    </div>

</div>

    <footer>
        <div class ="fooster-wrap">

            <div class="btn-wrap type03 grid4">
                <button type="button" class="btn xlg1 type01" id="nextButton">다음(1/9)</button>
            </div>
        </div>
    </footer>

</div>


</form>
</body>
<script>
    start("MIND_HEALTH");
</script>
</html>

<script>
    const questions =[
        "매사에 즐거움이나 흥미가 없다",
        "기분이 가라앉거나 우울하거나 희망이 없다고 느낀다",
        "잠들기 어렵거나 자주 깬다/혹은 잠을 너무 많이 잔다",
        "피곤하다고 느끼거나 기운이 거의 없다",
        "식욕이 줄었다/혹은 너무 많이 먹는다",
        "내 자신이 실패자로 여겨지거나 자신과 가족을 실망시켰다고 느낀다",
        "신문을 읽거나 TV를 보는 것과 같은 일상적인 일에 집중하기 어렵다",
        "다른 사람들이 눈치 챌 정도로 평소보다 말과 행동이 느리다/혹은 너무 안절부절 못해서 가만히 앉아 있을 수 없다",
        "차라리 죽는 것이 낫겠다고 생각하거나 어떻게든 자해를 하려고 생각한다",
     ];
    let currentPage =0;

    function createQuestionPage(question) {
        const contentDiv = document.getElementById("content");
        contentDiv.innerHTML = `
            <div class="cont-wrap type01">
                <div class="txt-m" style="padding: 15px">
                    <span style="font-size: 18px; line-height: 2.0;">
                        다음은 마음 상태에 대해 묻는</br>
                        질문입니다. 내용을 읽고 해당되는</br>
                        것을 선택해 주세요</br>
                    </span>
                    <div class="txt-m" style="padding: 10px">
                        <span style="font-size: 20px; line-height: 2.0;">
                            ${currentPage + 1}. ${question}
                        </span>
                    </div>
                    <div class="rdo-wrap grid-col type09">
                        <div class="rdo-box" id="chk_no"  data-value="0" onclick="mindscore_survey(this)">
                            <input type="radio" id="chk1" value="0">
                            <label for="chk1">전혀 없다</label>
                        </div>

                        <div class="rdo-box" id="chk_few" data-value="1" onclick="mindscore_survey(this)">
                            <input type="radio" id="chk2" value="1">
                            <label for="chk2">며칠 동안</label>
                        </div>

                        <div class="rdo-box" id="chk_week" data-value="2" onclick="mindscore_survey(this)">
                            <input type="radio" id="chk3" value="2">
                            <label for="chk3">일주일 이상</label>
                        </div>

                        <div class="rdo-box" id="chk_day" data-value="3" onclick="mindscore_survey(this)">
                            <input type="radio" id="chk4" value="3">
                            <label for="chk4">거의 매일</label>
                        </div>

                    </div>
                </div>
            </div>
        `;
    }





    function updatePageIndicator() {
        const totalPages = questions.length;
        const pageIndicator = `${currentPage + 1}/${totalPages}`;
        document.getElementById("nextButton").textContent = `다음(${pageIndicator})`;
    }

    document.getElementById("nextButton").addEventListener("click", function () {
        goToNextPage();
    });



let sum=0;

    function mindscore_survey(div) {

        const radios = ["chk_no", "chk_few", "chk_week", "chk_day"];

        for (const radio of radios) {
            const radioDiv = document.getElementById(radio);
            const radioInput = radioDiv.querySelector('input[type="radio"]');
            radioDiv.className = radio === div.id ? "rdo-box checked" : "rdo-box";
            radioInput.removeAttribute("checked");
        }

        div.querySelector('input[type="radio"]').setAttribute("checked", "");
        selectedValue = parseInt(div.getAttribute("data-value"));
        sum += selectedValue;
        // console.log(selectedValue);
        console.log(sum);
    }
    function goToNextPage() {
        if (selectedValue !== null) { // 선택한 값이 null이 아닌 경우에만 다음 페이지로 이동
            sum += selectedValue; // sum에 선택한 값 누적
            selectedValue = null; // 선택한 값 초기화
            currentPage++;

            if (currentPage >= questions.length) {
                window.location.href = "mindscore.html";
                return;
            }
            createQuestionPage(questions[currentPage]);
            updatePageIndicator();
        } else {
            alert("라디오 버튼을 선택해주세요.");
        }
    }
    function onFormSubmission(form) {
        goToNextPage();
        return false; // 폼 제출 방지
    }


</script>

